---
title: Office 365 の監査ログに監査を共有を使用します。
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: 2/13/2018
ms.audience: Admin
ms.topic: article
ms.service: o365-administration
localization_priority: Normal
search.appverid:
- SPO160
- MOE150
- BCS160
- MET150
ms.assetid: 50bbf89f-7870-4c2a-ae14-42635e0cfc01
description: '共有は、SharePoint Online およびビジネスのための OneDrive でのキー操作です。管理者を使用できます Office 365 の監査ログに監査を共有する方法の共有で使用されている自分の組織を決定します。 '
ms.openlocfilehash: 511f8b0e61d450659d78177d5b87fac9ee636cd4
ms.sourcegitcommit: 36c5466056cdef6ad2a8d9372f2bc009a30892bb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/27/2018
ms.locfileid: "22532259"
---
# <a name="use-sharing-auditing-in-the-office-365-audit-log"></a>Office 365 の監査ログに監査を共有を使用します。

SharePoint Online とのビジネス、OneDrive でのキー操作は、共有し、Office 365 の組織で広く使用されています。管理者を使用できます Office 365 の監査ログに監査を共有する方法の共有で使用されている自分の組織を決定します。 
  
## <a name="the-sharepoint-sharing-schema"></a>SharePoint 共有スキーマ

(除外ポリシーを共有および共有リンク イベント) 共有のイベントとは異なるファイルとフォルダー関連のイベントで 1 つの主な方法: 別のユーザーにいくつかの効果のあるアクションを 1 つのユーザーが実行します。たとえば、ユーザー A では、ファイルにユーザー B のアクセスが与えられます。この例では、ユーザー A は、*ユーザーが機能している*とユーザー B は、*移動先のユーザー*です。SharePoint ファイルのスキーマで機能しているユーザーのアクションは、ファイル自体をのみ影響します。**FileAccessed**のイベントで必要な情報だけのファイルをユーザー A が表示は、機能しているユーザーです。この違いに対処するため、*スキーマの SharePoint の共有*、共有イベントの詳細をキャプチャすると呼ばれる、別のスキーマがあります。これにより、管理者があるユーザーがリソースを共有することにより多くの洞察と、リソースのユーザーが共有されました。 
  
共有スキーマには、共有イベントに関連する監査ログ内の 2 つのフィールドが用意されています。 
  
- **TargetUserOrGroupName**では、UPN または移動先のユーザーまたは (前の例では、ユーザー B) を持つリソースが共有されているグループの名前を格納します。 
    
- **TargetUserOrGroupType**では、ターゲットのユーザーまたはグループは、メンバー、ゲスト、グループ、またはパートナーかどうかを識別します。 
    
Office 365 の他のプロパティに加えて、これらの 2 つのフィールドは、ユーザー、操作、および日付がについて完全に理解し、**どの*ユーザーが共有リソースを*対象*と*すると** ログのスキーマを監査します。 
  
ストーリーを共有する必要がある別のスキーマ プロパティがあります。**EventData**プロパティは、共有イベントに関する追加情報を格納します。たとえば、ユーザーは、他のユーザーとサイトを共有する場合これは、ターゲット ユーザーを SharePoint グループに追加します。**EventData**プロパティは、管理者のコンテキストを提供する追加情報をキャプチャします。 

## <a name="the-sharepoint-sharing-model-and-sharing-events"></a>SharePoint のモデルとイベントを共有

3 つの別々 のイベントで実際に定義されて共有: **SharingSet**、 **SharingInvitationCreated**、および**SharingInvitaitonAccepted**。次のイベントを共有する方法の作業の流れは、Office 365 の監査ログに記録されます。 
  
![監査を共有のしくみのフロー チャート](media/d83dd40f-919b-484f-bfd6-5dc8de31bff6.png)
  
(ターゲット ユーザー) の他のユーザーとリソースを共有するユーザー (機能しているユーザー) 場合、SharePoint (またはビジネスのための OneDrive) はまず移動先のユーザーの電子メール アドレスが既に組織のディレクトリ内のユーザー アカウントに関連付けられています。ターゲット ユーザーが組織のディレクトリにある場合は、SharePoint は、次を行います。
  
-  すぐにリソースにアクセスするターゲット ・ ユーザーのアクセス許可が割り当てられます。 
    
- ターゲット ユーザーの電子メール アドレスを共有の通知を送信します。
    
- **SharingSet**イベントをログに記録します。 
    
 ターゲット ユーザーのユーザー アカウントは、組織のディレクトリにない場合は、SharePoint は、次が。 
  
- 共有への招待を作成し、ターゲット ユーザーの電子メール アドレスに送信します。
    
- **SharingInvitationCreated**イベントをログに記録します。 
    
    > [!NOTE]
    > **SharingInvitationCreated**イベントは、外部またはゲストの共有ターゲット ユーザーが共有されているリソースへのアクセスを持っていない場合、ほとんど常に。 
  
ターゲット ユーザーが送信すること (リンクをクリックして招待状に)、SharePoint 共有への招待を受け入れると**SharingInvitationAccepted**のイベントをログに記録し、リソースにアクセスするターゲット ・ ユーザーのアクセス許可が割り当てられます。ターゲット ユーザーに関する追加情報も記録、招待状が送られてきたユーザーと実際には、出席依頼を承諾したユーザーの id などです。これらのユーザー (または電子メール アドレス) がいくつかのケースでは、異なる場合があります。 
  

  
## <a name="how-to-identify-resources-shared-with-external-users"></a>外部ユーザーと共有されているリソースを識別する方法

管理者の一般的な要件は、組織外のユーザーと共有されているすべてのリソースの一覧を作成しています。監査では、Office 365 の共有を使用して、管理者は今すぐこのリストを生成できます。ここではどのようにします。
  
### <a name="step-1-search-for-sharing-events-and-export-the-results-to-a-csv-file"></a>イベントを共有するための手順 1: 検索し、結果を CSV ファイルにエクスポートします。

最初のステップでは、イベントを共有するための Office 365 の監査ログを検索します。詳細 (必要なアクセス許可を含む) に関する監査ログの検索、参照してください[では、Office 365 のセキュリティ監査ログを検索する&amp;コンプライアンス センター](search-the-audit-log-in-security-and-compliance.md)です。
  
1. [https://protection.office.com](https://protection.office.com)。
    
2. 職場、学校のアカウントを使用して Office 365 にサインインします。
    
3. セキュリティの左側のウィンドウで&amp;コンプライアンス センター] をクリックして**検索&amp;調査**、**監査ログの検索**] をクリックします。
    
    **監査ログの検索**ページが表示されます。 
    
4. **アクティビティ**で [共有イベントだけを検索するのには、**共有アクティビティ**をクリックします。 
    
    ![アクティビティで [共有するアクティビティを選択します](media/46bb25b7-1eb2-4adf-903a-cc9ab58639f9.png)
  
5.  その期間内に発生した共有のイベントを検索する日付と時刻の範囲を選択します。 
    
6. 検索を実行する**検索**をクリックします。 
    
7. 実行と結果が表示される検索が完了すると、**結果のエクスポート**] をクリックして\>**すべての結果をダウンロード**します。
    
    エクスポート オプションを選択すると、開く、または CSV ファイルを保存するように要求するウィンドウの下部にあるメッセージが表示されます。
    
8. **保存**] をクリックして\>**として保存**し、ローカル コンピューター上のフォルダーに CSV ファイルを保存します。 
    

  
### <a name="step-2-filter-the-csv-file-for-resources-shared-with-external-users"></a>ステップ 2: CSV ファイルの外部ユーザーと共有されているリソースをフィルター処理します。

次に、 **SharingSet**と**SharingInvitationCreated**のイベントで CSV にフィルターを適用して、それらのイベントを表示するのには、 **TargetUserOrGroupType**プロパティでは、**ゲスト**です。Excel でこれを行う電源クエリ機能を使用します。2016 の Excel では、次の手順が実行されます。 
  
1. Excel の 2016年には、空白のブックを開きます。
    
2. [**データ** ] タブをクリックします。 
    
3. **新しいクエリ**をクリックして\>**ファイルから** \> **から CSV**です。
    
    ![[データ] タブで、新しいクエリを選択して、ファイルから選択し、CSV から](media/5170ab34-b449-40ea-bd3f-f1432c1c5973.png)
  
4. 手順 1 でダウンロードした CSV ファイルを開きます。
    
    CSV ファイルはクエリ ・ エディターで開かれます。4 つの列があることに注意してください:**時間**、**ユーザー**、**アクション**、および**詳細**。**詳細**列は、複数のプロパティのフィールドです。次の手順では、各プロパティの [**詳細**] 列に新しい列を作成します。 
    
5. **詳細**列を選択し、[**ホーム**] タブで、**列を分割する** \> **での区切り記号**。
    
    ![[ホーム] タブで、分割列] をクリックし、区切り記号](media/aeb503e8-565b-42ea-91e2-9f127a74c00c.png)
  
6. ウィンドウで、**区切り文字で列を分割する**には、次の操作を行います。 
    
      - **選択するか区切り記号を入力して**、**コンマ**を選択します。
    
      - **分割**では、[**区切り記号の各アイテム**を選択します。
    
7. **[OK]** をクリックします。
    
    **詳細**列は、複数の列に分割されます。新しい列のそれぞれは、 **Detail.1**、 **Detail.2**、 **Detail.3**というように呼びます。**Detail.n**列の各セルの値のプロパティの名前が付きますがわかりますたとえば、**操作: SharingSet**、**操作: SharingInvitationAccepted**、および**操作: SharingInvitationCreated**にします。
    
    ![詳細列は、プロパティごとに 1 つ、複数の列に分割します。](media/4b104ead-0313-4bd4-b2a9-f143ccb378ac.png)
  
8. [**ファイル**] タブをクリックして**を閉じる&amp;ロード**クエリ ・ エディターを終了し、Excel ブックのファイルを開きます。 
    
    次の手順では、のみイベントを表示する、 **SharingSet**および**SharingInvitationCreated**ファイルをフィルター処理します。 
    
9. **[ホーム**] タブに移動し、[**アクション**] 列を選択します。 
    
10. **ソート&amp;フィルター** 」ドロップ ダウン リスト、すべての選択: **SharingSet**と**SharingInvitationCreated**を選択し、 **[ok]** をクリックしてクリアします。
    
    Excel では**SharingSet**と**SharingInvitationCreated**のイベントの行が表示されます。 
    
11. **Detail.17** (またはいずれかの列には、 **TargetUserOrGroupType**プロパティが含まれています) という名前の列に移動し、それを選択します。 
    
12. **ソート&amp;フィルター** 」ドロップ ダウン リスト、すべての選択: **TargetUserOrGroupType:Guest**を選択し、 **[ok]** をクリックしてクリアします。
    
    ここで Excel は、外部ユーザーが**TargetUserOrGroupType:Guest**の値によって識別されるため、 **SharingInvitationCreated**と**SharingSet**のイベントは、ターゲットである別の組織では、行を表示します。 
    
次の表は、指定した日付の範囲内でのゲスト ユーザーとリソースを共有する組織のすべてのユーザーを示します。
  
![Office 365 の共有のイベントの監査ログ](media/0e0ecbe3-c794-4ca6-a2ca-63478fb3bb34.png)
  
**Detail.10**列 (または、**オブジェクト Id**のプロパティを含んでいる列) がターゲット ・ ユーザーと共有されていたリソースを識別するには上記の表には含まれていません、たとえば`ObjectId:https:\/\/contoso-my.sharepoint.com\/personal\/sarad_contoso_com\/Documents\/Southwater Proposal.docx`。
  
> [!TIP]
> 識別する場合は、ゲスト ユーザーが実際に割り当てるとリソースにアクセスするアクセス許可 (リソースだけではなくその場所に共有)、手順 10、11、12、および、 **SharingInvitationAccepted**と**SharingSet にフィルターを適用**手順 10 でのイベントです。 
