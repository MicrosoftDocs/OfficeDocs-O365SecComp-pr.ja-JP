---
title: スパム対策メッセージ ヘッダー
ms.author: krowley
author: kccross
manager: laurawi
ms.date: ''
ms.audience: ITPro
ms.topic: article
ms.service: O365-seccomp
ms.custom: TN2DMC
localization_priority: Normal
search.appverid:
- MET150
ms.assetid: 2e3fcfc5-5604-4b88-ac0a-c5c45c03f1db
description: Exchange Online Protection では、受信電子メール メッセージをスキャンするときに、 **X-Forefront-Antispam-Report** ヘッダーをそれぞれのメッセージに挿入します。
ms.openlocfilehash: d887fea94bac6177dde69fac9586d7d562ef50de
ms.sourcegitcommit: 03b9221d9885bcde1cdb5df2c2dc5d835802d299
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/29/2019
ms.locfileid: "29614461"
---
# <a name="anti-spam-message-headers"></a>スパム対策メッセージ ヘッダー

Exchange Online Protection では、受信電子メール メッセージをスキャンするときに、 **X-Forefront-Antispam-Report** ヘッダーをそれぞれのメッセージに挿入します。このヘッダー内のフィールドは、そのメッセージに関する情報やそれがどのように処理されたかに関する情報を管理者に提供できます。 **X-Microsoft-Antispam** ヘッダー内のフィールドは、バルク メールやフィッシングについての追加情報を提供します。これら 2 つのヘッダーのほかに、Exchange Online Protection も電子メール認証の結果を **Authentication-results** ヘッダーで処理する各メッセージに挿入します。
  
> [!TIP]
> さまざまな電子メール クライアントで電子メール メッセージ ヘッダーを表示する方法については、「[メッセージ ヘッダー アナライザー](https://go.microsoft.com/fwlink/p/?LinkId=306583)」を参照してください。メッセージ ヘッダーの内容は、コピーして[メッセージ ヘッダー アナライザー](https://testconnectivity.microsoft.com/?tabid=mha) ツールに貼り付けることができます。Exchange 管理センターで検疫内のメッセージを選択した場合は、 **[メッセージ ヘッダーの表示]** リンクを使ってメッセージ ヘッダー テキストをコピーしてツールに貼り付けることもできます。メッセージ ヘッダー アナライザー ツールに貼り付ければ、 **[ヘッダーの分析]** をクリックしてヘッダーに関する情報を取得できます。
  
## <a name="x-forefront-antispam-report-message-header-fields"></a>X-Forefront-Antispam-Report メッセージ ヘッダー フィールド
<a name="sectionSection0"> </a>

メッセージ ヘッダー情報にアクセスしたら、 **X-Forefront-Antispam-Report** を検索して、次に示すフィールドを確認します。このヘッダー内のその他のフィールドは、Microsoft スパム対策チームが診断のために専用で使用します。

|**ヘッダー フィールド**|**説明**|
|:-----|:-----|
|CIP:[IP アドレス]|接続 IP アドレス接続フィルターで IP 許可一覧と IP 禁止一覧を作成する際、この IP アドレスを指定することができます。詳細については、「[接続フィルター ポリシーを構成する](configure-the-connection-filter-policy.md)」を参照してください。  |
|CTRY|サービスに接続されたメッセージの発信国。これは、接続先 IP アドレスから特定されます。そのため、発信元の送信先 IP アドレスとは異なる可能性があります。|
|LANG|メッセージが作成された言語であり、国番号 (たとえば、ロシア語は ru_RU) で指定されます。|
|SCL|メッセージの Spam Confidence Level (SCL) 値。これらの値の解釈方法については、「[Spam Confidence Level](spam-confidence-levels.md)」を参照してください。  |
|PCL|メッセージの Phishing Confidence Level (PCL) 値。PCL 値の詳細については、「[PCL](anti-spam-message-headers.md#PCL)」を参照してください。  |
|SRV:BULK|メッセージが一括電子メール メッセージとして識別されました。 **[バルクメール メッセージをすべてブロックする]** 詳細スパム フィルター オプションが有効になっている場合、このメッセージがスパムとしてマークされます。このオプションが有効になっていない場合は、残りのフィルター処理ルールでそのメッセージがスパンであると判断された場合にのみスパムとしてマークされます。  |
|SFV:SFE|メッセージが個人の差出人セーフ リスト上のアドレスから送信されているため、フィルター処理が省略され、メッセージはそのまま配信されました。|
|SFV:BLK|メッセージが個人の受信拒否リスト上のアドレスから送信されているため、フィルター処理が省略され、メッセージはブロックされました。  <br/> **ヒント**: エンド ・ ユーザーが安全でブロックされている送信者リストを作成する方法の詳細についてを参照してください[ブロック (迷惑メールの設定) を許可する、または](https://go.microsoft.com/fwlink/p/?LinkId=294862)(Outlook web 上) と[迷惑メール フィルターの概要](https://go.microsoft.com/fwlink/p/?LinkId=270065)(Outlook)。|
|IPV:CAL|このメッセージの IP アドレスは接続フィルターの IP 許可一覧に指定されているため、スパム フィルターの通過を許可されました。|
|IPV:NLI|IP アドレスが IP 評価リストに掲載されていませんでした。|
|SFV:SPM|コンテンツ フィルターによって、メッセージがスパムとしてマークされました。|
|SFV:SKS|コンテンツ フィルターによって処理される前に、メッセージがスパムとしてマークされました。これには、メッセージを自動的にスパムとしてマークし、他のすべてのフィルター処理を省略するトランスポート ルールに適合したメッセージが含まれます。|
|SFV:SKA|メッセージは、スパム フィルター ポリシーの許可リスト ( **送信者の許可**リストなど) と一致したため、フィルタリングをスキップして受信トレイに配信されました。|
|SFV:SKB|メッセージは、スパム フィルター ポリシーの拒否リスト ( **送信者の拒否**リストなど) と一致したため、スパムとしてマークされました。|
|SFV:SKN|コンテンツ フィルターによって処理される前に、メッセージが非スパムとしてマークされました。これには、メッセージを自動的に非スパムとしてマークし、他のすべてのフィルター処理を省略するトランスポート ルールに適合したメッセージが含まれます。|
|SFV:SKI|SFV:SKN と同様に、メッセージはテナント内の組織内電子メールであるなどの別の理由でフィルター処理が省略されました。|
|SFV:SKQ|メッセージは検疫から解放され、目的の受信者に送信されました。|
|SFV:NSPM|メッセージがスパムではないとしてマークされ、意図された受信者に送信されました。|
|H:[helostring]|接続元のメール サーバーの HELO または EHLO 文字列。|
|PTR:[ReverseDNS]|逆引き DNS アドレスとも呼ばれる、送信元の IP アドレスの PTR レコード (またはポインター レコード)。|
|SFTY|メッセージは、フィッシング詐欺として識別され、も、次の値のいずれかでマークされます。 <br/>• 9.1: 既定値です。メッセージは、フィッシング詐欺の URL が含まれています、その他のフィッシング詐欺の内容が含まれている可能性があります。 または可能性がありますとマークされているフィッシング詐欺の設置型バージョンの Exchange Server などの別のメール フィルターにより Office 365 にメッセージを中継する前に。 <br/>• 9.11: メッセージには、スプーフィング対策のチェックが失敗した場所から送信側のドメイン: ヘッダーが同じに合わせて、または受信側のドメインと同じ組織の一部であります。これは、組織内通信のなりすましの安全性のヒントは、メッセージに追加することを示します。 <br/>• 9.19: メッセージが送信側のドメインが、受信側が所有しているドメイン、またはフィッシング詐欺対策のポリシーによって保護されているカスタムのドメインを偽装するように試みているドメイン偽装のチェックに失敗しました。アンチ ・ Phishig ・ ポリシーを使用して有効になっている場合、偽装の安全性のヒントは、メッセージに追加することを示しますこの。 <br/>• 9.20: メッセージには、受信側の組織内でユーザーを偽装しようとして送信しているユーザーまたはカスタムのユーザーがフィッシング詐欺対策のポリシーによって保護されているユーザーの偽装のチェックが失敗しました。アンチ ・ Phishig ・ ポリシーを使用して有効になっている場合、偽装の安全性のヒントは、メッセージに追加することを示しますこの。 <br/>• 9.21: スプーフィング対策のチェックと送信側ドメインからのメッセージが失敗しました: ヘッダーは、認証しないと、外部ドメインからです。CompAuth との組み合わせで使用されている (認証の結果を参照してください)。 <br/>• 9.22: ユーザーがオーバーライドされた差出人セーフ リストを持っていることを除いて、9.21 と同じです。 <br/>• 9.23: 組織には、許可された送信者またはドメインがオーバーライドされることを除いて、9.22 と同じです。 <br/>• 9.24: ユーザーがオーバーライドされた Exchange メール フローのルールを持っていることを除いて、9.23 と同じです。|
|X-CustomSpam:[ASFOption]|メッセージには、高度なスパム フィルターのオプションが一致します。たとえば、 **X CustomSpam: イメージをリモート ・ サイトへのリンク****のリモート ・ サイトへの画像リンク**の ASF のオプションが一致したことを示します。X ヘッダー テキストはそれぞれ特定の ASF オプションの追加については、[高度な迷惑メール フィルターのオプション](advanced-spam-filtering-asf-options.md)を参照してください。|
   
## <a name="x-microsoft-antispam-message-header-fields"></a>X-Microsoft-Antispam メッセージ ヘッダー フィールド
<a name="sectionSection1"> </a>

次の表に、 **X-Microsoft-Antispam** メッセージ ヘッダー内の便利なフィールドを示します。このヘッダー内のその他のフィールドは、Microsoft スパム対策チームが診断のために専用で使用します。
  
|**ヘッダー フィールド**|**説明**|
|:-----|:-----|
|BCL|メッセージの Bulk Complaint Level (BCL)。詳細については、「[バルク苦情レベルの値](bulk-complaint-level-values.md)」を参照してください。  |
|PCL|フィッシング信頼レベル (PCL)、フィッシング メッセージであるかどうかを示すメッセージの。このステータスは、次の数値の 1 つとして返されます。<br/>• **0-3**: メッセージの内容がフィッシング詐欺である可能性がありますはありません。 <br/>• **4-8**: メッセージの内容がフィッシング詐欺である可能性があります。 <br/>• **-9990**: (Exchange のオンライン保護のみ)、メッセージの内容がフィッシング詐欺である可能性があります。  <br/>  メッセージに、電子メール クライアントが実行するアクションを決定する値が使用されます。たとえば、不審なメッセージのコンテンツをブロックするのに PCL スタンプが使用されます。フィッシング詐欺、および Outlook がフィッシング詐欺メッセージを処理する方法の詳細については、[オンまたはオフは、電子メール メッセージ内のリンク](https://support.office.com/article/2D79B907-93B6-4774-82E6-1F0385CF20F8)を参照してください。|
   
## <a name="authentication-results-message-header"></a>Authentication-results メッセージ ヘッダー
<a name="sectionSection2"> </a>

メール サーバーが電子メール メッセージを受信すると、SPF、DKIM、および DMARC に対するチェックの結果が Office 365 によって、 **Authentication-results** メッセージ ヘッダーに記録またはスタンプされます。
  
### <a name="check-stamp-syntax-and-examples"></a>check stamp 構文と例
<a name="referenceSPFstamp"> </a>

次に示す構文の例では、Office 365 がメール サーバーでの受信時に電子メールの認証チェックを受ける各メールのメッセージ ヘッダーに適用するテキスト "スタンプ" の一部を示しています。このスタンプは **Authentication-Results** ヘッダーに追加されます。
  
 **構文:SPF check stamp**
  
SPF の場合は、次の構文を適用します。
  
```
spf=<pass (IP address)|fail (IP address)|softfail (reason)|neutral|none|temperror|permerror> smtp.mailfrom=<domain>
```

 **例:SPF check stamp**
  
```
spf=pass (sender IP is 192.168.0.1) smtp.mailfrom=contoso.com
spf=fail (sender IP is 127.0.0.1) smtp.mailfrom=contoso.com
```

 **構文:DKIM check stamp**
  
DKIM の場合は、次の構文を適用します。
  
```
dkim=<pass|fail (reason)|none> header.d=<domain>
```

 **例:DKIM check stamp**
  
```
dkim=pass (signature was verified) header.d=contoso.com
dkim=fail (body hash did not verify) header.d=contoso.com
```

 **構文:DMARC check stamp**
  
DMARC の場合は、次の構文を適用します。
  
```
dmarc=<pass|fail|bestguesspass|none> action=<permerror|temperror|oreject|pct.quarantine|pct.reject> header.from=<domain>
```

 **例:DMARC check stamp**
  
```
dmarc=pass action=none header.from=contoso.com
dmarc=bestguesspass action=none header.from=contoso.com
dmarc=fail action=none header.from=contoso.com
dmarc=fail action=oreject header.from=contoso.com
```

### <a name="authentication-results-message-header-fields-used-by-office-365-email-authentication"></a>Office 365 の電子メールの認証で使用される Authentication-results メッセージ ヘッダー フィールド
<a name="referenceSPFstamp"> </a>

フィールドと各電子メールの認証チェックに使用できる値を次の表に示します。
  
|**ヘッダー フィールド**|**説明**|
|:-----|:-----|
|spf|メッセージの SPF チェックの結果についての説明。次の値を指定できます。  <br/>• の **(IP アドレス) を渡す**: 渡されたメッセージの SPF チェックを示し、送信者の IP アドレスが含まれています。クライアントは、送信または送信者のドメインに代わって電子メールを中継する権限が。<br/>• の**失敗 (IP アドレス)**: 失敗したメッセージの SPF チェックを示し、送信者の IP アドレスが含まれています。これは、機能は、_ハードは失敗_とも呼ばれます。<br/>• **softfail (理由)**: 遷移では、SPF レコードとして送信することが認められていないホストを指定するにはあることを示します。 <br/>•**ニュートラル**:、SPF レコードは、明示的に記されているいないをアサートしている IP アドレスが承認されているかどうかを示します。 <br/>• **[なし]**: ドメインに SPF レコードがないか、SPF レコードが結果に評価されないことを示します。 <br/>• **temperror**: を示す一時的なもの、たとえば、DNS エラーにエラーが発生することがあります。管理者操作をしなくても後でもう一度実行可能性がありますしようとしています。<br/>• **permerror**: 永続的なエラーが発生したことを示します。これは、場合、たとえば、ドメインには、不正な形式の SPF レコードです。|
|smtp.mailfrom|メッセージが送信された送信元のドメインを含みます。この電子メール メッセージに関するすべてのエラーは、ポスト マスターまたはドメインを担当するエンティティに送信されます。これは、メッセージ エンベロープの 5321.MailFrom アドレスまたはリバースパス アドレスとも呼ばれます。|
|dkim|メッセージの DKIM チェックの結果についての説明。次の値を指定できます。  <br/>• に**渡す**: DKIM チェックに渡されたメッセージを示します。 <br/>• は **(理由) が失敗する**: DKIM のチェックに失敗しましたメッセージを示すとその理由です。例では、メッセージが署名されていない場合や、署名を確認できませんでした。<br/>• **[なし]**: メッセージが署名されていないことを示します。できない可能性があります DKIM レコードがドメインにあることや、DKIM レコードは、結果のみこのメッセージが署名されていないことには評価されません。|
|header.d|DKIM 署名で識別されるドメイン (存在する場合)。 これは、公開キーを照会するドメインです。|
|dmarc|メッセージの DMARC チェックの結果についての説明。次の値を指定できます。  <br/>• に**渡す**: DMARC チェックに渡されたメッセージを示します。 <br/>• の**失敗**: DMARC のチェックに失敗しましたメッセージを示します。 <br/>• **bestguesspass**: ドメインの DMARC TXT レコードが存在しないが、DMARC の確認メッセージが成功する 1 つが存在した場合のことを示します。5321.MailFrom アドレスのドメイン 5322.From のアドレスのドメインと一致するためです。<br/>• **[なし]**: 送信側のドメインを DNS に DKIM の TXT レコードが存在しないことを示します。|
|action|DMARC チェックの結果に基づいて、スパム フィルターが実行するアクションを示します。例:  <br/>• **permerror**: DNS の記録など、形式が正しくない DMARC TXT、DMARC の評価中に永続的なエラーが発生しました。このメッセージを再送しようとしていますは、さまざまな結果で終了する可能性があります。代わりに、問題を解決するためにドメインの所有者に連絡する必要があります。<br/>• **temperror**: DMARC の評価中に一時的なエラーが発生しました。送信者が電子メールを正しく処理するために、後でメッセージを再送信を要求することができます。<br/>• **oreject**または**o.reject**: の拒否をオーバーライドします。DMARC TXT レコードは、p のポリシーを持つドメインから、DMARC に失敗したメッセージを受信したときにこのアクションを確認してこの場合は Office 365 を使用して = 拒否しています。削除するか、メッセージを拒否して、代わりには、Office 365 は、スパムとしてメッセージをマークします。Office 365 は、このような方法を構成する理由の詳細については、 [DMARC を失敗した電子メールを受信する方法 Office 365 のハンドル](use-dmarc-to-validate-email.md#inbounddmarcfail)を参照してください。<br/>• **pct.quarantine**: DMARC を渡さないようにする必要のあるメッセージの 100% より小さい値がこのまま配信されることを示します。つまり、メッセージには、DMARC が失敗しました。 しを検疫すると、ポリシーが設定されたが、pct フィールドが 100% に設定されていない、指定されたドメインのポリシーに従って、DMARC アクションを適用しないように、システムがランダムに決定します。<br/>• **pct.reject**: DMARC を渡さないようにする必要のあるメッセージの 100% より小さい値がこのまま配信されることを示します。つまり、メッセージには、DMARC が失敗しました。 し拒否するにはポリシーが設定されたが、pct フィールドが 100% に設定されていない、指定されたドメインのポリシーに従って、DMARC アクションを適用しないように、システムがランダムに決定します。|
|header.from|電子メール メッセージのヘッダーに From アドレスのドメインです。_5322.From_アドレスとも呼びます。|
|compauth|複合認証の結果です。認証 SPF、DKIM、DMARC、またはメッセージが認証済みかどうかを確認するメッセージの他の部分などの複数の種類を組み合わせるには、Office 365 で使用されます。From を使用して: 評価の基礎としてのドメインです。|
|理由|理由複合認証は、合格または失敗します。理由の値は、3 桁の数字で構成されています。<br/>• **000**: メッセージは、認証を明示的に失敗しました。たとえば、メッセージ検疫または拒否のアクションを伴う DMARC の失敗を受信しました。<br/>• **001**: メッセージでは、認証では、暗黙的に失敗しました、送信側のドメインは、認証ポリシーを公開できませんでした。ポリシーなどの DMARC の p = なし。<br/>• **1 xx**: メッセージには認証が渡されます。次の 2 桁は、Office 365 で使用される内部のコードです。<br/>• **2 xx**: メッセージ ソフト渡される認証します。次の 2 桁は、Office 365 で使用される内部のコードです。<br/>• **3 xx**: 複合認証のメッセージがチェックされませんでした。 <br/>• **4 xx**: メッセージは、複合認証をバイパスします。次の 2 桁は、Office 365 で使用される内部のコードです。|
