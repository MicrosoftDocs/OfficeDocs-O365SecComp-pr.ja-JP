---
title: office 365 の分離とアクセス制御 (office 365)
ms.author: robmazz
author: robmazz
manager: laurawi
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
ms.collection:
- Strat_O365_IP
- M365-security-compliance
description: '概要: Office 365 のさまざまなアプリケーションでの分離とアクセス制御について説明します。'
ms.openlocfilehash: c4328539f8cca5cb7e76c4a3175cfab0a01b42cf
ms.sourcegitcommit: 0017dc6a5f81c165d9dfd88be39a6bb17856582e
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32262626"
---
# <a name="isolation-and-access-control-in-office-365"></a><span data-ttu-id="e2639-103">Office 365 での分離とアクセス制御</span><span class="sxs-lookup"><span data-stu-id="e2639-103">Isolation and Access Control in Office 365</span></span>

<span data-ttu-id="e2639-104">Azure Active Directory と Office 365 では、非常に複雑なデータモデルが使用されています。これには、数百のエンティティ、数千件の関係、および数万の属性 (エンティティ、リレーションシップ、属性は、アプリケーションに固有のもの) が含まれています。</span><span class="sxs-lookup"><span data-stu-id="e2639-104">Azure Active Directory and Office 365 use a highly complex data model that includes tens of services, hundreds of entities, thousands of relationships, and tens of thousands of attributes (entities, relationships and attributes are often application-specific).</span></span> <span data-ttu-id="e2639-105">高レベルでは、Azure Active Directory とサービスディレクトリがテナントと受信者のコンテナーになり、状態ベースのレプリケーションプロトコルを使用して同期されたままになります。</span><span class="sxs-lookup"><span data-stu-id="e2639-105">At a high level, Azure Active Directory and the service directories are the containers of tenants and recipients, and they are kept in sync using state-based replication protocols.</span></span> <span data-ttu-id="e2639-106">Azure Active directory 内に保持されているディレクトリ情報に加えて、各サービスにも独自のディレクトリサービスインフラストラクチャがあります (例: Exchange online ディレクトリサービス、SharePoint Online ディレクトリサービスなど)。</span><span class="sxs-lookup"><span data-stu-id="e2639-106">In addition to the directory information held within Azure Active Directory, each of the services also have their own directory services infrastructure (e.g., Exchange Online Directory Services, SharePoint Online Directory Services, etc.).</span></span> 
 
![Office 365 テナントデータ同期](media/office-365-isolation-tenant-data-sync.png)

<span data-ttu-id="e2639-108">このモデルでは、ディレクトリデータの単一のソースはありません。</span><span class="sxs-lookup"><span data-stu-id="e2639-108">Within this model, there is no single source of directory data.</span></span> <span data-ttu-id="e2639-109">個々のデータの各部分は特定のシステムによって所有されますが、すべてのデータが1つのシステムに保持されるわけではありません。</span><span class="sxs-lookup"><span data-stu-id="e2639-109">Every individual piece of data is owned by a specific system, but no single system holds all the data.</span></span> <span data-ttu-id="e2639-110">Office 365 サービスは、Azure Active Directory と連携してデータモデルを実現します。</span><span class="sxs-lookup"><span data-stu-id="e2639-110">Office 365 services cooperate with Azure Active Directory to realize the data model.</span></span> <span data-ttu-id="e2639-111">Azure Active Directory は、共有データの "真実のシステム" です。通常、すべてのサービスで頻繁に使用される小さなデータおよび静的データです。</span><span class="sxs-lookup"><span data-stu-id="e2639-111">Azure Active Directory is the "system of truth" for shared data, which is typically small and static data used often by every service.</span></span> <span data-ttu-id="e2639-112">Office 365 および Azure Active Directory 内で使用されているフェデレーションモデルは、データの共有ビューを提供します。</span><span class="sxs-lookup"><span data-stu-id="e2639-112">The federated model used within Office 365 and Azure Active Directory provides the shared view of the data.</span></span>

<span data-ttu-id="e2639-113">Office 365 は、物理ストレージと Azure クラウドストレージの両方を使用します。</span><span class="sxs-lookup"><span data-stu-id="e2639-113">Office 365 uses both physical storage and Azure cloud storage.</span></span> <span data-ttu-id="e2639-114">exchange online (exchange online Protection を含む) および Skype for business は、お客様のデータに独自のストレージを使用します。</span><span class="sxs-lookup"><span data-stu-id="e2639-114">Exchange Online (including Exchange Online Protection) and Skype for Business use their own storage for customer data.</span></span> <span data-ttu-id="e2639-115">SharePoint Online では、SQL Server ストレージと Azure ストレージの両方を活用しているため、ストレージレベルでお客様のデータをさらに分離する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e2639-115">SharePoint Online leverages both its SQL Server storage and Azure storage, which necessitates the need for additional isolation of customer data at the storage level.</span></span>

## <a name="exchange-online"></a><span data-ttu-id="e2639-116">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="e2639-116">Exchange Online</span></span>
<span data-ttu-id="e2639-117">Exchange Online は、メールボックスデータベースと呼ばれる拡張記憶域エンジン (ESE) データベース内でホストされているメールボックス内に顧客データを格納します。</span><span class="sxs-lookup"><span data-stu-id="e2639-117">Exchange Online stores customer data within mailboxes that are hosted within Extensible Storage Engine (ESE) databases called mailbox databases.</span></span> <span data-ttu-id="e2639-118">これには、ユーザーメールボックス、リンクされたメールボックス、共有メールボックス、およびパブリックフォルダーメールボックスが含まれます。</span><span class="sxs-lookup"><span data-stu-id="e2639-118">This includes user mailboxes, linked mailboxes, shared mailboxes and public folder mailboxes.</span></span> <span data-ttu-id="e2639-119">ユーザーメールボックスには、会話の履歴など、保存された Skype for business コンテンツを含めることもできます。</span><span class="sxs-lookup"><span data-stu-id="e2639-119">User mailboxes may also include saved Skype for Business content, such as conversation histories.</span></span> <span data-ttu-id="e2639-120">ユーザーメールボックスのコンテンツには、メール、電子メールの添付ファイル、予定表と空き時間情報、連絡先、タスク、メモ、グループ、および推論データが含まれます。</span><span class="sxs-lookup"><span data-stu-id="e2639-120">User mailbox content includes emails and email attachments, calendaring and free/busy information, contacts, tasks, notes, Groups, and inference data.</span></span>

<span data-ttu-id="e2639-121">Exchange Online 内の各メールボックスデータベースには、複数のテナントからのメールボックスが含まれています。</span><span class="sxs-lookup"><span data-stu-id="e2639-121">Each mailbox database within Exchange Online contains mailboxes from multiple tenants.</span></span> <span data-ttu-id="e2639-122">すべてのメールボックスは、テナント内などの認証コードで保護されています。</span><span class="sxs-lookup"><span data-stu-id="e2639-122">All mailboxes are secured by authorization code, including within a tenancy.</span></span> <span data-ttu-id="e2639-123">Exchange の社内展開と同様に、既定では、割り当てられたユーザーのみがメールボックスにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="e2639-123">As with an on-premises deployment of Exchange, by default only the assigned user has access to a mailbox.</span></span> <span data-ttu-id="e2639-124">メールボックスをセキュリティで保護するアクセス制御リスト (ACL) には、テナントレベルで Azure Active Directory によって認証された id が含まれています。</span><span class="sxs-lookup"><span data-stu-id="e2639-124">The access control list (ACL) that secures a mailbox contains an identity that is authenticated by Azure Active Directory at the tenant level.</span></span> <span data-ttu-id="e2639-125">特定のテナントのメールボックスは、そのテナントの認証プロバイダーに対して認証された id に制限されます。これには、そのテナントのユーザーのみが含まれます。</span><span class="sxs-lookup"><span data-stu-id="e2639-125">The mailboxes for a given tenant are limited to identities authenticated against that tenant's authentication provider, which include only users from that tenant.</span></span> <span data-ttu-id="e2639-126">TenantA によって明示的に承認されていない限り、TenantA に属するコンテンツは、tenantb でユーザーが取得することはできません。</span><span class="sxs-lookup"><span data-stu-id="e2639-126">Content belonging to TenantA cannot in any way be obtained by users in TenantB, unless explicitly approved by TenantA.</span></span>

## <a name="skype-for-business"></a><span data-ttu-id="e2639-127">Skype for Business</span><span class="sxs-lookup"><span data-stu-id="e2639-127">Skype for Business</span></span>
<span data-ttu-id="e2639-128">Skype for business は、さまざまな場所にデータを格納します。</span><span class="sxs-lookup"><span data-stu-id="e2639-128">Skype for Business stores data in a variety of places:</span></span>
- <span data-ttu-id="e2639-129">接続エンドポイント、テナント id、ダイヤルプラン、ローミング設定、プレゼンス状態、連絡先リストなどが含まれるユーザーおよびアカウント情報は、skype for business の Active Directory サーバーに格納されるほか、さまざまな skype for business データベースに保存されます。サーバ.</span><span class="sxs-lookup"><span data-stu-id="e2639-129">User and account information, which includes connection endpoints, tenant IDs, dial plans, roaming settings, presence state, contact lists, etc., is stored in the Skype for Business Active Directory servers, as well as in various Skype for Business database servers.</span></span> <span data-ttu-id="e2639-130">ユーザーが両方の製品に対して有効になっている場合、またはユーザーがいない場合、Skype for business サーバーでユーザーの Exchange Online メールボックスに連絡先リストが格納されます。</span><span class="sxs-lookup"><span data-stu-id="e2639-130">Contact lists are stored in the user's Exchange Online mailbox if the user is enabled for both products, or on Skype for Business servers if the user is not.</span></span> <span data-ttu-id="e2639-131">Skype for business データベースサーバーはテナントごとにパーティション分割されませんが、マルチテナントのデータの分離は RBAC によって実行されます。</span><span class="sxs-lookup"><span data-stu-id="e2639-131">Skype for Business database servers are not partitioned per-tenant, but multi-tenancy isolation of data is enforced through RBAC.</span></span>
- <span data-ttu-id="e2639-132">Skype for business 会議中にコンテンツユーザーがアップロードするなどの会議コンテンツは、分散ファイルシステム共有に保存されます。</span><span class="sxs-lookup"><span data-stu-id="e2639-132">Meeting content, such as content users upload during Skype for Business meetings, is stored on Distributed File System shares.</span></span> <span data-ttu-id="e2639-133">このコンテンツは、Exchange Online でアーカイブすることもできます。アーカイブは有効になっています。</span><span class="sxs-lookup"><span data-stu-id="e2639-133">This content can also be archived in Exchange Online provided archiving is enabled.</span></span> <span data-ttu-id="e2639-134">DFS 共有はテナントごとにパーティション分割されませんが、コンテンツは acl で保護され、マルチテナントは RBAC を介して適用されます。</span><span class="sxs-lookup"><span data-stu-id="e2639-134">The DFS shares are not partitioned per-tenant but the content is secured with ACLs and multi-tenancy is enforced through RBAC.</span></span>
- <span data-ttu-id="e2639-135">通話の詳細レコード (通話履歴、im セッション、アプリケーション共有、IM 履歴など) を Exchange Online に格納することもできますが、ほとんどの通話詳細レコードは、通話詳細記録 (CDR) サーバーに一時的に格納されます。</span><span class="sxs-lookup"><span data-stu-id="e2639-135">Call detail records, which is the activity history, such as call history, IM sessions, application sharing, IM history, etc., can also be stored in Exchange Online, but most call detail records are temporarily stored on call detail record (CDR) servers.</span></span> <span data-ttu-id="e2639-136">コンテンツはテナントごとにパーティション分割されませんが、マルチテナントは RBAC を介して適用されます。</span><span class="sxs-lookup"><span data-stu-id="e2639-136">Content is not partitioned per tenant, but multi-tenancy is enforced through RBAC.</span></span>

## <a name="sharepoint-online"></a><span data-ttu-id="e2639-137">SharePoint Online</span><span class="sxs-lookup"><span data-stu-id="e2639-137">SharePoint Online</span></span>
<span data-ttu-id="e2639-138">SharePoint Online には、データの分離を提供する、いくつかの独立したメカニズムがあります。</span><span class="sxs-lookup"><span data-stu-id="e2639-138">There are several independent mechanisms unique to SharePoint Online that provide data isolation.</span></span> <span data-ttu-id="e2639-139">SharePoint Online は、オブジェクトをアプリケーションデータベース内に抽象化されたコードとして格納します。</span><span class="sxs-lookup"><span data-stu-id="e2639-139">SharePoint Online stores objects as abstracted code within application databases.</span></span> <span data-ttu-id="e2639-140">たとえば、ユーザーがファイルを SharePoint Online にアップロードすると、そのファイルは逆アセンブルされてアプリケーションコードに変換され、複数のデータベースにわたって複数のテーブルに格納されます。</span><span class="sxs-lookup"><span data-stu-id="e2639-140">For example, when a user uploads a file to SharePoint Online, that file is disassembled and translated into application code and stored in multiple tables across multiple databases.</span></span>

<span data-ttu-id="e2639-141">ユーザーがデータが格納されているストレージに直接アクセスできる場合、そのコンテンツは、人間または SharePoint Online 以外のシステムには解釈されません。</span><span class="sxs-lookup"><span data-stu-id="e2639-141">If a user could gain direct access to the storage containing the data, the content would not be interpretable to a human or any system other than SharePoint Online.</span></span> <span data-ttu-id="e2639-142">これらのメカニズムには、セキュリティアクセス制御およびプロパティが含まれます。</span><span class="sxs-lookup"><span data-stu-id="e2639-142">These mechanisms include security access control and properties.</span></span> <span data-ttu-id="e2639-143">前述したように、すべての SharePoint Online リソースは、テナント内の認証コードおよび RBAC ポリシーによって保護されています。</span><span class="sxs-lookup"><span data-stu-id="e2639-143">As described above, all SharePoint Online resources are secured by the authorization code and RBAC policy, including within a tenancy.</span></span> <span data-ttu-id="e2639-144">リソースを保護するアクセス制御リスト (ACL) には、テナントレベルで認証された id が含まれています。</span><span class="sxs-lookup"><span data-stu-id="e2639-144">The access control list (ACL) that secures a resource contains an identity that is authenticated at the tenant level.</span></span> <span data-ttu-id="e2639-145">SharePoint online では、Exchange online と同様に、特定のテナントのデータは、そのテナントの認証プロバイダーに対して認証された id に制限されます。これには、そのテナントのユーザーのみが含まれます。</span><span class="sxs-lookup"><span data-stu-id="e2639-145">As with Exchange Online, in SharePoint Online, data for a given tenant are limited to identities authenticated against that tenant's authentication provider, which include only users from that tenant.</span></span>

<span data-ttu-id="e2639-146">acl に加えて、認証プロバイダ (テナント固有の Azure Active Directory) を指定するテナントレベルのプロパティは一度書き込まれます。一度設定すると、設定後に変更することはできません。</span><span class="sxs-lookup"><span data-stu-id="e2639-146">In addition to the ACLs, a tenant level property that specifies the authentication provider (which is the tenant-specific Azure Active Directory), is written once and cannot be changed once set.</span></span> <span data-ttu-id="e2639-147">テナントに対して認証プロバイダのテナントプロパティを設定すると、テナントに公開されている api を使用して変更することはできません。</span><span class="sxs-lookup"><span data-stu-id="e2639-147">Once the authentication provider tenant property has been set for a tenant, it cannot be changed using any APIs exposed to a tenant.</span></span>

<span data-ttu-id="e2639-148">一意の*SubscriptionId*はテナントごとにも使用されます。</span><span class="sxs-lookup"><span data-stu-id="e2639-148">A unique *SubscriptionId* is also used for each tenant.</span></span> <span data-ttu-id="e2639-149">すべての顧客サイトはテナントで所有され、テナントに固有の*SubscriptionId*が割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="e2639-149">All customer sites are owned by a tenant and are assigned a *SubscriptionId* unique to the tenant.</span></span> <span data-ttu-id="e2639-150">サイトの*SubscriptionId*プロパティは一度だけ書き込まれ、変更することはできません。</span><span class="sxs-lookup"><span data-stu-id="e2639-150">The *SubscriptionId* property on a site is written once and cannot be changed.</span></span> <span data-ttu-id="e2639-151">サイトは、テナントに割り当てられた後、コンテンツストア API を使用して後で別のテナントに移動することはできません。</span><span class="sxs-lookup"><span data-stu-id="e2639-151">Once a site is assigned to a tenant, it cannot be moved to a different tenant later using the content store API.</span></span> <span data-ttu-id="e2639-152">*SubscriptionId*は、認証プロバイダーのセキュリティスコープを作成するために使用されるキーでもあり、テナントに関連付けられています。</span><span class="sxs-lookup"><span data-stu-id="e2639-152">The *SubscriptionId* is also the key that is used to create the security scope for the authentication provider and is tied to the tenant.</span></span>

<span data-ttu-id="e2639-153">SharePoint Online は、コンテンツの格納に SQL Server と Azure ストレージを使用します。</span><span class="sxs-lookup"><span data-stu-id="e2639-153">SharePoint Online uses SQL Server and Azure storage for the storing of content.</span></span> <span data-ttu-id="e2639-154">SQL レベルでは、コンテンツストアのパーティションキーは*SiteId*化されます。</span><span class="sxs-lookup"><span data-stu-id="e2639-154">At the SQL level, the partition key for the content store is *SiteId*.</span></span> <span data-ttu-id="e2639-155">SQL クエリを実行すると、SharePoint Online はテナントレベルの*SubscriptionId*チェックの一部として確認された*SiteId*を使用します。</span><span class="sxs-lookup"><span data-stu-id="e2639-155">When running a SQL query, SharePoint Online uses a *SiteId* that has been verified as part of a tenant-level *SubscriptionId* check.</span></span>

<span data-ttu-id="e2639-156">SharePoint Online は、Microsoft Azure でファイルバイナリ blob (ファイルストリームなど) を格納します。</span><span class="sxs-lookup"><span data-stu-id="e2639-156">SharePoint Online stores file binary blobs (e.g., the file streams) in Microsoft Azure.</span></span> <span data-ttu-id="e2639-157">各 SharePoint Online ファームには独自の Microsoft Azure アカウントがあり、Azure に保存されているすべての blob は、SQL コンテンツストアに格納されているキーを使用して個別に暗号化されます。</span><span class="sxs-lookup"><span data-stu-id="e2639-157">Each SharePoint Online farm has its own Microsoft Azure account and all the blobs saved in Azure are encrypted individually using a key that is stored in the SQL content store.</span></span> <span data-ttu-id="e2639-158">暗号化キーはエンドユーザーに直接公開されず、承認レイヤーによってコードで保護されます。</span><span class="sxs-lookup"><span data-stu-id="e2639-158">The encryption key is not exposed directly to the end user, and is protected in code by the authorization layer.</span></span> <span data-ttu-id="e2639-159">最後に、SharePoint Online では、HTTP 要求が複数のテナントに対してデータを読み書きするタイミングを検出するためのリアルタイム監視が行われています。</span><span class="sxs-lookup"><span data-stu-id="e2639-159">Finally, SharePoint Online has real-time monitoring in place to detect when an HTTP request reads or writes data for more than one tenant.</span></span> <span data-ttu-id="e2639-160">これは、アクセスされるリソースの*subscriptionid*に対して、要求 id の*subscriptionid*を追跡することによって行われます。</span><span class="sxs-lookup"><span data-stu-id="e2639-160">It does this by tracking the *SubscriptionId* of the request identity against the *SubscriptionId* of the resource being accessed.</span></span> <span data-ttu-id="e2639-161">複数のテナントのリソースにアクセスする要求は、エンドユーザーによって発生することはありません。</span><span class="sxs-lookup"><span data-stu-id="e2639-161">A request accessing resources of more than one tenant should never happen by end-user.</span></span> <span data-ttu-id="e2639-162">これはマルチテナント環境でのサービス要求に対して発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="e2639-162">It can happen for service requests in a multi-tenant environment, though.</span></span> <span data-ttu-id="e2639-163">たとえば、検索クローラーは、データベース全体に対するコンテンツの変更を一度に1つずつ取得します。</span><span class="sxs-lookup"><span data-stu-id="e2639-163">For example, the search crawler pulls content changes for an entire database all at once.</span></span> <span data-ttu-id="e2639-164">通常、1つのサービス要求で複数のテナントのサイトに対してクエリを実行する必要があります。これは、効率性上の理由によります。</span><span class="sxs-lookup"><span data-stu-id="e2639-164">This usually involves querying sites of more than one tenant in a single service request, which is done for efficiency reasons.</span></span>
