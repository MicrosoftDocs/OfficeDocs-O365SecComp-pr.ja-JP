---
title: Office 365 の分離と Office 365 でのアクセス制御
ms.author: robmazz
author: robmazz
manager: laurawi
ms.date: 8/21/2018
audience: ITPro
ms.topic: article
ms.service: Office 365 Administration
localization_priority: None
search.appverid:
- MET150
ms.collection: Strat_O365_Enterprise
description: '概要: Office 365 のさまざまなアプリケーション内で独立性とアクセス ・ コントロールの説明。'
ms.openlocfilehash: c1989bc546df357740ea963a1a241dfa14557931
ms.sourcegitcommit: 36c5466056cdef6ad2a8d9372f2bc009a30892bb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/27/2018
ms.locfileid: "22532701"
---
# <a name="isolation-and-access-control-in-office-365"></a><span data-ttu-id="36a68-103">Office 365 での分離とアクセス制御</span><span class="sxs-lookup"><span data-stu-id="36a68-103">Isolation and Access Control in Office 365</span></span>

<span data-ttu-id="36a68-p101">Azure Active Directory と Office 365 サービスでは、数百のエンティティの数十が含まれる非常に複雑なデータ モデルを使用して、リレーションシップ、および属性の数万の数千 (エンティティ、リレーションシップ、および属性は、多くの場合アプリケーション固有)。高レベルは、Azure Active Directory とのディレクトリ サービスは、テナントと受信者のコンテナーとの同期の状態ベースのレプリケーション プロトコルを使用して保持されています。Azure Active Directory 内で保持されているディレクトリ情報の他の各サービスもある (例えば、オンラインの Exchange ディレクトリ サービス、SharePoint のオンライン ディレクトリ サービスなど) が独自のディレクトリ サービス インフラストラクチャ</span><span class="sxs-lookup"><span data-stu-id="36a68-p101">Azure Active Directory and Office 365 use a highly complex data model that includes tens of services, hundreds of entities, thousands of relationships, and tens of thousands of attributes (entities, relationships and attributes are often application-specific). At a high level, Azure Active Directory and the service directories are the containers of tenants and recipients, and they are kept in sync using state-based replication protocols. In addition to the directory information held within Azure Active Directory, each of the services also have their own directory services infrastructure (e.g., Exchange Online Directory Services, SharePoint Online Directory Services, etc.).</span></span> 
 
![Office 365 テナント データの同期](media/office-365-isolation-tenant-data-sync.png)

<span data-ttu-id="36a68-p102">このモデル内では、ディレクトリ データの 1 つのソースはありません。特定のシステムでは、すべて個別のデータが所有しているが、1 つのシステムには、すべてのデータは保持されません。Office 365 サービスは、データ モデルを実現する Active Directory を Azure と連動します。Azure Active Directory は、共有データは、通常、静的データのすべてのサービスによって頻繁に使用されるは「本当のシステム」です。Office 365 と Azure Active Directory 内で使用するフェデレーション モデルは、データの共有ビューを提供します。</span><span class="sxs-lookup"><span data-stu-id="36a68-p102">Within this model, there is no single source of directory data. Every individual piece of data is owned by a specific system, but no single system holds all the data. Office 365 services cooperate with Azure Active Directory to realize the data model. Azure Active Directory is the "system of truth" for shared data, which is typically small and static data used often by every service. The federated model used within Office 365 and Azure Active Directory provides the shared view of the data.</span></span>

<span data-ttu-id="36a68-p103">Office 365 では、物理ストレージと Azure クラウド ストレージの両方を使用します。Exchange オンライン (Exchange のオンライン保護を含む) であり、ビジネス用の Skype は、お客様のデータの独自のストレージを使用します。SharePoint Online は、SQL Server のストレージと Azure のストレージ、ストレージ ・ レベルでの顧客データの追加の分離の必要性を利用しています。</span><span class="sxs-lookup"><span data-stu-id="36a68-p103">Office 365 uses both physical storage and Azure cloud storage. Exchange Online (including Exchange Online Protection) and Skype for Business use their own storage for customer data. SharePoint Online leverages both its SQL Server storage and Azure storage, which necessitates the need for additional isolation of customer data at the storage level.</span></span>

## <a name="exchange-online"></a><span data-ttu-id="36a68-116">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="36a68-116">Exchange Online</span></span>
<span data-ttu-id="36a68-p104">オンラインの Exchange メールボックス データベースの Extensible Storage Engine (ESE) データベース内でホストされているメールボックス内の顧客データを格納します。これには、ユーザーのメールボックス、リンクされたメールボックス、共有メールボックスおよびパブリック フォルダーのメールボックスが含まれます。ユーザーのメールボックスでは、会話の履歴などのビジネス ・ コンテンツの保存されている Skype を含めることもできます。ユーザーのメールボックスの内容には、電子メールおよび電子メールの添付ファイル、予定表データや空き時間情報、連絡先、タスク、メモ、グループ、および推論データが含まれています。</span><span class="sxs-lookup"><span data-stu-id="36a68-p104">Exchange Online stores customer data within mailboxes that are hosted within Extensible Storage Engine (ESE) databases called mailbox databases. This includes user mailboxes, linked mailboxes, shared mailboxes and public folder mailboxes. User mailboxes may also include saved Skype for Business content, such as conversation histories. User mailbox content includes emails and email attachments, calendaring and free/busy information, contacts, tasks, notes, Groups, and inference data.</span></span>

<span data-ttu-id="36a68-p105">Exchange Online 内の各メールボックス データベースには、複数のテナントからのメールボックスが含まれています。テナント内を含む、認証コードをすべてのメールボックスをセキュリティで保護されています。として設置型の Exchange の導入に既定で割り当てられたユーザーのみがアクセスのメールボックスにします。メールボックスをセキュリティで保護するアクセス制御リスト (ACL) には、テナントのレベルでの Azure Active Directory によって認証された id が含まれています。特定のテナントのメールボックスは、テナントのユーザーだけが含まれて、そのテナントの認証プロバイダーに対して認証ユーザーに制限されます。TenantA に属するコンテンツ何らかの方法で取得できません TenantB、内のユーザーが TenantA で明示的に承認されていない限り。</span><span class="sxs-lookup"><span data-stu-id="36a68-p105">Each mailbox database within Exchange Online contains mailboxes from multiple tenants. All mailboxes are secured by authorization code, including within a tenancy. As with an on-premises deployment of Exchange, by default only the assigned user has access to a mailbox. The access control list (ACL) that secures a mailbox contains an identity that is authenticated by Azure Active Directory at the tenant level. The mailboxes for a given tenant are limited to identities authenticated against that tenant's authentication provider, which include only users from that tenant. Content belonging to TenantA cannot in any way be obtained by users in TenantB, unless explicitly approved by TenantA.</span></span>

## <a name="skype-for-business"></a><span data-ttu-id="36a68-127">Skype for Business</span><span class="sxs-lookup"><span data-stu-id="36a68-127">Skype for Business</span></span>
<span data-ttu-id="36a68-128">ビジネス用の Skype は、さまざまな場所にデータを格納します。</span><span class="sxs-lookup"><span data-stu-id="36a68-128">Skype for Business stores data in a variety of places:</span></span>
- <span data-ttu-id="36a68-p106">ユーザーとについては、テナント Id、接続のエンドポイントが含まれていますが、ダイヤルの計画、設定、状態は、連絡先リストなどのローミング アカウントが格納されているビジネスの Active Directory サーバーでは、Skype とビジネス データベースのさまざまな Skypeサーバーです。連絡先リストは、ユーザーが有効な場合の両方の製品、または Skype のビジネス サーバーのユーザー名がない場合、ユーザーの Exchange Online のメールボックスに格納されます。Skype ビジネス データベース ・ サーバではパーティション分割されたテナントごとではありませんが、RBAC を使用データのマルチ テナント機能の分離が適用されます。</span><span class="sxs-lookup"><span data-stu-id="36a68-p106">User and account information, which includes connection endpoints, tenant IDs, dial plans, roaming settings, presence state, contact lists, etc., is stored in the Skype for Business Active Directory servers, as well as in various Skype for Business database servers. Contact lists are stored in the user's Exchange Online mailbox if the user is enabled for both products, or on Skype for Business servers if the user is not. Skype for Business database servers are not partitioned per-tenant, but multi-tenancy isolation of data is enforced through RBAC.</span></span>
- <span data-ttu-id="36a68-p107">コンテンツのユーザーは、会議の Skype 中にアップロードするなど、ミーティングのコンテンツは、分散ファイル システム共有に格納されます。このコンテンツはアーカイブが有効になっていれば、Exchange Online のアーカイブも。DFS 共有は、テナントごとの分割ではないですが、Acl を使用してコンテンツを保護し、RBAC を使用、マルチ テナント機能を適用します。</span><span class="sxs-lookup"><span data-stu-id="36a68-p107">Meeting content, such as content users upload during Skype for Business meetings, is stored on Distributed File System shares. This content can also be archived in Exchange Online provided archiving is enabled. The DFS shares are not partitioned per-tenant but the content is secured with ACLs and multi-tenancy is enforced through RBAC.</span></span>
- <span data-ttu-id="36a68-p108">呼び出しの詳細レコード、活動履歴、通話履歴、IM セッション、アプリケーション共有、IM の履歴など、あるは、Exchange online では、保存することもですが、ほとんどの呼び出しの詳細レコードは、通話詳細記録 (CDR) のサーバーに一時的に格納します。コンテンツが、テナントごとに分割されていますが、RBAC を使用、マルチ テナント機能が適用されます。</span><span class="sxs-lookup"><span data-stu-id="36a68-p108">Call detail records, which is the activity history, such as call history, IM sessions, application sharing, IM history, etc., can also be stored in Exchange Online, but most call detail records are temporarily stored on call detail record (CDR) servers. Content is not partitioned per tenant, but multi-tenancy is enforced through RBAC.</span></span>

## <a name="sharepoint-online"></a><span data-ttu-id="36a68-137">SharePoint Online</span><span class="sxs-lookup"><span data-stu-id="36a68-137">SharePoint Online</span></span>
<span data-ttu-id="36a68-p109">SharePoint Online にデータの分離を提供する一意なはいくつかの独立したメカニズムがあります。SharePoint Online は、アプリケーション データベースの抽象化されたコードとオブジェクトを格納します。などの SharePoint Online にファイルをアップロードすると、そのファイルは分解し、アプリケーション コードに変換し、複数のデータベース間で複数のテーブルに格納されています。</span><span class="sxs-lookup"><span data-stu-id="36a68-p109">There are several independent mechanisms unique to SharePoint Online that provide data isolation. SharePoint Online stores objects as abstracted code within application databases. For example, when a user uploads a file to SharePoint Online, that file is disassembled and translated into application code and stored in multiple tables across multiple databases.</span></span>

<span data-ttu-id="36a68-p110">ユーザーがデータを格納している記憶域への直接アクセスを取得する場合、コンテンツは人間または SharePoint Online 以外のシステムを正しく解釈できません。これらのメカニズムには、セキュリティのアクセス制御およびプロパティが含まれます。前述したように、SharePoint Online のすべてのリソースは、認証コードと、テナント内を含め、RBAC のポリシーによって保護されています。リソースをセキュリティで保護するアクセス制御リスト (ACL) には、テナントのレベルで認証された id が含まれています。同様に Exchange でオンラインに、SharePoint Online は、特定のテナントのデータは、テナントのユーザーだけが含まれて、そのテナントの認証プロバイダーに対して認証ユーザーに制限されます。</span><span class="sxs-lookup"><span data-stu-id="36a68-p110">If a user could gain direct access to the storage containing the data, the content would not be interpretable to a human or any system other than SharePoint Online. These mechanisms include security access control and properties. As described above, all SharePoint Online resources are secured by the authorization code and RBAC policy, including within a tenancy. The access control list (ACL) that secures a resource contains an identity that is authenticated at the tenant level. As with Exchange Online, in SharePoint Online, data for a given tenant are limited to identities authenticated against that tenant's authentication provider, which include only users from that tenant.</span></span>

<span data-ttu-id="36a68-p111">だけでなく、Acl は、(ある特定のテナントの Azure Active Directory)、認証プロバイダーを指定するテナント レベルのプロパティは、1 回だけ書き込まれ、一度設定を変更することはできません。テナントの認証プロバイダーのテナントのプロパティを設定すると、テナントに公開されているすべての Api に変更できません。</span><span class="sxs-lookup"><span data-stu-id="36a68-p111">In addition to the ACLs, a tenant level property that specifies the authentication provider (which is the tenant-specific Azure Active Directory), is written once and cannot be changed once set. Once the authentication provider tenant property has been set for a tenant, it cannot be changed using any APIs exposed to a tenant.</span></span>

<span data-ttu-id="36a68-p112">固有の*サブスクリプション Id*は、各テナントに対しても使用されます。顧客のすべてのサイトでは、テナントが所有し、テナントには、*サブスクリプション Id*固有を割り当てられました。サイトの*サブスクリプション Id*プロパティでは、1 回書き込まれ、変更することはできません。サイトがテナントに割り当てられた後は、コンテンツ ストア API を使用して後で別のテナントに移動できません。*サブスクリプション Id*が認証プロバイダーのセキュリティ スコープを作成するために使用し、テナントに関連付けられているキーもあります。</span><span class="sxs-lookup"><span data-stu-id="36a68-p112">A unique *SubscriptionId* is also used for each tenant. All customer sites are owned by a tenant and are assigned a *SubscriptionId* unique to the tenant. The *SubscriptionId* property on a site is written once and cannot be changed. Once a site is assigned to a tenant, it cannot be moved to a different tenant later using the content store API. The *SubscriptionId* is also the key that is used to create the security scope for the authentication provider and is tied to the tenant.</span></span>

<span data-ttu-id="36a68-p113">SharePoint Online のコンテンツを格納するため、SQL Server と Azure のストレージを使用します。SQL レベルでは、*サイト Id*はコンテンツ ・ ストアのパーティション キーです。SQL クエリを実行すると、SharePoint Online を使用が確認された*サイト Id*テナント レベルの*サブスクリプション Id*チェックの一環として。</span><span class="sxs-lookup"><span data-stu-id="36a68-p113">SharePoint Online uses SQL Server and Azure storage for the storing of content. At the SQL level, the partition key for the content store is *SiteId*. When running a SQL query, SharePoint Online uses a *SiteId* that has been verified as part of a tenant-level *SubscriptionId* check.</span></span>

<span data-ttu-id="36a68-p114">SharePoint Online は、Microsoft Azure でファイルのバイナリ blob (ファイル ストリームなど) を格納します。各 SharePoint Online のファームには、Microsoft Azure アカウントと、Azure に保存されているすべての blob が、SQL コンテンツ ストアに格納されているキーを使用して個別に暗号化されます。暗号化キーは、エンド ・ ユーザーに直接公開されないと承認レイヤーによってコード内で保護されています。最後に、SharePoint Online は、読み取りまたは書き込みの 1 つ以上のテナントのデータが HTTP 要求を検出するための場所でリアルタイムに監視します。この機能を使用するには、アクセス対象のリソースの*サブスクリプション Id*に対して要求 id の*サブスクリプション Id*を追跡します。複数のテナントのリソースへのアクセス要求は、エンド ・ ユーザーによって得ない。発生することが、マルチ テナント環境でのサービス ・ リクエストのも。たとえば、検索クローラーはデータベース全体の内容の変更をすべてを一度に取得します。通常は、効率上の理由から行われますが、1 つのサービスの要求で複数のテナントのサイトを照会します。</span><span class="sxs-lookup"><span data-stu-id="36a68-p114">SharePoint Online stores file binary blobs (e.g., the file streams) in Microsoft Azure. Each SharePoint Online farm has its own Microsoft Azure account and all the blobs saved in Azure are encrypted individually using a key that is stored in the SQL content store. The encryption key is not exposed directly to the end user, and is protected in code by the authorization layer. Finally, SharePoint Online has real-time monitoring in place to detect when an HTTP request reads or writes data for more than one tenant. It does this by tracking the *SubscriptionId* of the request identity against the *SubscriptionId* of the resource being accessed. A request accessing resources of more than one tenant should never happen by end-user. It can happen for service requests in a multi-tenant environment, though. For example, the search crawler pulls content changes for an entire database all at once. This usually involves querying sites of more than one tenant in a single service request, which is done for efficiency reasons.</span></span>
