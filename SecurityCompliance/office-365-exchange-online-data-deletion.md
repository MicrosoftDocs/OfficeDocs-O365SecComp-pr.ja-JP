---
title: Office 365 Exchange Online データの削除
ms.author: robmazz
author: robmazz
manager: laurawi
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
ms.collection:
- Strat_O365_IP
- M365-security-compliance
description: Exchange Online でのソフトおよびハードデータの削除の処理方法。
ms.openlocfilehash: 5886d4ab2ffee69f3db8659b7bc642ccad2afa90
ms.sourcegitcommit: f0d23e57b00f07cef5b1b2d366eaeeeacda37e3e
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/18/2019
ms.locfileid: "35786662"
---
# <a name="exchange-online-data-deletion-in-office-365"></a>Office 365 での Exchange Online データの削除
Exchange Online では、次の2種類の削除があります。ソフト削除とハード削除です。 これは、メールボックス内のメールボックスとアイテムの両方に適用されます。

## <a name="soft-deleted-and-hard-deleted-mailboxes"></a>回復可能な削除と削除によって削除されたメールボックス
回復可能な削除によって削除されたユーザーメールボックスは、Microsoft 365 管理センターまたはメールボックス削除コマンドレットを使用して削除されたメールボックスであり、まだ Azure Active Directory のごみ箱に含まれていた場合、30日未満です。 メールボックスは、次のいずれかの方法で回復可能な削除になることがあります。
- ユーザーメールボックスの関連付けられた Azure Active Directory ユーザーアカウントが、回復可能な削除によって削除されている (ユーザーオブジェクトがスコープ外またはごみ箱のコンテナー内にある)。
- ユーザーメールボックスの関連付けられた Azure Active Directory ユーザーアカウントは物理的に削除されていますが、Exchange Online メールボックスは訴訟ホールドまたは電子情報開示ホールドの対象になっています。
- ユーザーメールボックスに関連付けられている Azure Active Directory ユーザーアカウントが過去30日以内に削除されています。Exchange Online では、保持期間の最大値は、完全に削除されて回復不能になる前に、メールボックスが回復可能な状態で保持されるようになります。

ハード削除されたユーザーメールボックスは、次のいずれかの方法で削除されたメールボックスです。
- ユーザーメールボックスが30日以上回復可能な削除によって削除されており、関連付けられた Azure Active Directory ユーザーが物理的に削除されている。 メール、連絡先、ファイルなど、すべてのメールボックスの内容は完全に削除されます。
- ユーザーメールボックスに関連付けられているユーザーアカウントが、Azure Active Directory から物理的に削除されています。 これで、ユーザーメールボックスは Exchange Online でソフト削除され、回復可能な削除の状態は30日間保持されます。 30日の期間内に、新しい Azure Active Directory ユーザーが同じ**exchangeguid**または**アーカイブ guid**を持つ元の受信者アカウントから同期されている場合、その新しいアカウントに Exchange Online のライセンスが付与されます。これにより、元のユーザーのメールボックス。 メール、連絡先、ファイルなど、すべてのメールボックスの内容は完全に削除されます。
- 回復可能な削除によって削除されたメールボックスは、 **PermanentlyDelete**を使用して削除されます。

上記の削除シナリオでは、訴訟ホールドや電子情報開示の保留など、ユーザーのメールボックスが保留状態になっていないことを前提としています。 メールボックスに何らかの種類の保留がある場合は、そのメールボックスを削除することはできません。 すべてのメールユーザーの受信者の種類について、[保留](https://support.office.com/article/manage-legal-investigations-in-office-365-2e5fbe9f-ee4d-4178-8ff8-4356bc1b168e?ui=en-US&rs=en-US&ad=US)設定は無視され、ハード削除または回復的な削除には影響しません。

## <a name="soft-deleted-and-hard-deleted-items"></a>回復可能な削除と削除によって削除されたアイテム
ユーザーがメールボックスアイテム (電子メールメッセージ、連絡先、予定表、タスクなど) を削除すると、アイテムは [回復可能なアイテム] フォルダーに移動され、"削除" という名前のサブフォルダーに移動されます。 これは、ソフト削除と呼ばれます。 削除したアイテムが [削除] フォルダーに保持される期間は、メールボックスに設定された 削除済アイテムの保持期間によって決まります。 Exchange Online メールボックスは、既定では、削除済みアイテムを14日間保持しますが、Exchange Online 管理者はこの設定を変更して、期間を最大で30日まで延長することができます。 (Exchange Online メールボックスの削除済みアイテムの保存期間を延長する詳細な手順については、「 [Exchange online メールボックスの完全に削除されたアイテムを保持](https://docs.microsoft.com/exchange/recipients-in-exchange-online/manage-user-mailboxes/change-deleted-item-retention)する期間を変更する」を参照してください)。削除されたアイテムの保存期間が切れる前に、削除されたアイテムを回復、または削除することができます。 そのためには、Microsoft Outlook または web 上の Outlook の削除済みアイテムの回復機能を使用します。

ユーザーが Outlook または web 上の Outlook の削除済みアイテムの回復機能を使用して削除済みアイテムを削除した場合、そのアイテムはハード削除と呼ばれます。 Exchange Online では、新しいメールボックスが作成されると、既定では単一アイテムの回復が有効になっているため、管理者は削除済みアイテムの保存期間の期限が切れる前に、削除済みのアイテムを[回復](https://docs.microsoft.com/Exchange/recipients/user-mailboxes/recover-deleted-messages)することができます。 また、単一アイテムの回復が有効になっていれば、ユーザーまたはプロセスによってメッセージが変更されたときに、元のアイテムのコピーの保存も行われます。

## <a name="page-zeroing"></a>ページ完全消去
** ゼロ化は、削除されたデータが回復しにくくなるように、ゼロまたはバイナリパターンを削除されたデータに書き込むセキュリティメカニズムです。 Exchange Online では、メールボックスデータベースはストレージの単位として*ページ*を使用し、*ページ解放*と呼ばれる上書きプロセスを実装します。 ページの解放は既定で有効になっており、ユーザーまたは Microsoft によって無効にすることはできません。 ページ解放操作は、指定したデータベースのすべてのコピーが同様の方法でページ指定されるように、トランザクションログファイルに記録されます。 アクティブなデータベースコピーでページを解放すると、ページはデータベースのパッシブコピーでゼロになります。

ページの解放は、ハード削除されたレコードよりもバイナリパターンを書き込みます。 ページ解放パターンは、拡張記憶域エンジン (ESE) 操作 (Exchange Online のサーバーで使用される内部データベースエンジンの名前) に固有であり、実行時操作とバックグラウンドデータベース保守操作では異なります。 (バックグラウンドデータベース保守は、各データベースを継続的にチェックし、スキャンするプロセスです。 その主な機能はデータベースページのチェックサムになりますが、ストアのクラッシュが原因で、消去されていないレコードやページはクリアされます。

次の表に、特定の実行時操作に対応したパターンを一覧表示します。

| ESE 実行時操作   | パターン |
|--------------------------|--------------|
| 置換                  | R            |
| レコード/長い値の削除 | D            |
| 解放されたページ領域         | H            |


次の表は、ESE バックグラウンド データベース保守で実行される特定の操作に対応したパターンの一覧です。

| ESE バックグラウンド データベース保守操作 | パターン |
|-----------------------------------------------|--------------|
| レコードの削除                                 | D            |
| 長い値の削除                             | L            |
| 部分的に使用されたページの解放されたページ領域       | Z            |
| 未使用ページの解放されたページ領域               | U            |


### <a name="page-zeroing-process"></a>ページ解放プロセス
ページの解放のプロセスは、削除のシナリオによって異なります。 次の表に、データベースの削除のシナリオ、およびページ解放機能が実行される時点について説明します。

| データベースの削除のシナリオ | データベース データを解放するための ESE プロセスと期間 |
|-----------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| アイテムの有効期限は、削除済みアイテムの保存期間に基づいています。 | 非同期のスレッドは、バイナリ パターンを削除されたデータに上書きします。 この操作はレコード削除の数ミリ秒以内に実行されます。 非同期の解放作業がまだ完了している間にストアプロセスがクラッシュした場合 (またはバージョンストアの拡張によってバージョンストアのクリーンアップが取り消された場合)、バックグラウンドデータベース保守がデータベースのそのセクションを処理するときに、解放が完了します。 |
| シナリオを表示する: Outlook/Outlook on the web フォルダービューでのアイテムの有効期限 (会話ビューなど) | バックグラウンド データベース保守でデータベースのこのセクションが処理されたときに、データ解放が実行されます。 |
| メールボックスの移動/メールボックスの削除のシナリオ: ソースメールボックスの削除 (削除されたメールボックスの有効期限) | バックグラウンド データベース保守でデータベースのこのセクションが処理されたときに、データ解放が実行されます。 |

### <a name="mailbox-data-types-without-page-zeroing"></a>ページ解放を使用しないメールボックス データの種類
次のメールボックスのデータ型には、ページの解放に関する規定はありません。
- **メールボックスデータベーストランザクションログ**-通常の操作の一部としてトランザクションログが削除された場合、削除されたログファイルを保存したファイルシステムのブロックをゼロにするプロセスはありません。 ファイルシステムによって、新しく作成されたログ用にその空き領域がすぐに再利用される可能性がありますが、これが行われる保証はありません。
- **コンテンツインデックスカタログファイル**-Exchange Online は検索インデックス機能に search Foundation (または高速) を使用します。 検索インデックスカタログは、メールボックスデータベースファイルと同じボリュームに格納されている数十のファイルで構成されています。 メッセージがメールボックス データベースから物理的に削除されても、検索カタログ内の関連付けられているコンテンツはすぐには削除されません。 コンテンツ削除が行われるのは、Search Foundation が多数の小さなカタログファイルを単一の大きなファイルにシャドウ (またはマスタマージ) した場合です。 マスター結合が完了すると、小さいカタログ ファイルが削除されます。 削除されたカタログ ファイルを保存しているブロックを解放するプロセスはありません。

## <a name="continuous-replication"></a>連続レプリケーション
連続レプリケーション (ログ配布と再生とも呼ばれます) は、Exchange Online のテクノロジで、高可用性、サイトの復元、および障害復旧を提供するために、すべてのメールボックスデータベースのコピーを作成および保持します。 連続レプリケーションは、Exchange Server データベースのクラッシュ回復サポートを活用して、メールボックスデータベースの1つ以上のコピーの非同期更新を実行するテクノロジを提供します。 各メールボックスサーバーは、アクティブデータベース (たとえば、ユーザーの電子メールアクティビティ) に対して行われたデータベースの更新を、1 MB のトランザクションログファイルのシーケンシャルセットのログレコードとして記録します。 この一連のファイルは、ログストリームと呼ばれます。 連続レプリケーションでは、ログストリームを使用して、データベースの1つ以上のコピーを非同期的に更新することもできます。 これは、アクティブデータベースのパッシブコピーを含む場所にログを転送し、パッシブデータベースコピーにログを再生することによって実現されます。 アクティブデータベースのすべてのログがデータベースのパッシブコピーに対して再生されている場合は、2つのデータベースが同等であるため、このプロセスを通じて、アクティブデータベースに加えられた物理的な変更が、そのデータベースのすべてのパッシブコピーにレプリケートされます。

メールボックスのアイテムまたはメールボックス全体であるかどうかにかかわらず、メールボックスデータベースから削除されているかどうか、および削除またはハード削除のどちらであるかは、アクティブデータベースに対する物理的な変更を表します。 ページの解放により、アクティブなデータベースが物理的に変更されることもあります。 これらの変更は連続レプリケーションと呼ばれるプロセスによってログファイルに書き込まれ、それらのログファイルがデータベースのパッシブコピーに対して再生されると、それらのパッシブデータベースに対して同じ物理的な変更が行われます。